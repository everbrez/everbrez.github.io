---
layout: post
title:  DOM
date:   2019-02-15
categories: Javascript 
---

# 节点
### 节点层次

1. 文档只有一个根节点，即`document`，html为其唯一的子节点

### 节点类型
一共具有12中节点类型，所有节点都继承自Node类型

1. Node.ELEMENT_NODE(1)
2. Node.ATTRIBUTE_NODE(2)
3. Node.TEXT_NODE(3)
4. Node.CDATA_SECTION_NODE(4)
5. Node.ENTITY_REFERENCE_NODE(5)
6. Node.ENTITY_NODE(6)
7. Node.PROCESSING_INSTRUCTION_NODE(7)
8. Node.COMMENT_NODE(8)
9. Node.DOCUMENT_NODE(9)
10. Node.DOCUMENT_TYPE_NODE(10)
11. Node.DOCUMENT_FRAGMENT_NODE(11)
12. Node.NOTATION_NODE(12)

属性
- nodeType 上方12中之一
- nodeName
- nodeValue

> 对于元素节点，nodeName中保存的都是元素的标签名，nodeValue保存的始终是null

### 节点关系
每一个节点都保存着一个`childNodes`属性，保存着一个`NodeList`对象，指向子节点

`NodeList`通过下面属性访问
1. 方括号
2. .item()

关系：
- childNodes
- firstChild
- lastChild
- parentNode
- previousSibling
- nextSibling
- element.compareDocumentPosition()
  - 1 无关
  - 2 居前
  - 4 居后
  - 8 包含
  - 16 被包含

### 操作节点

- hasChildNodes()
- appendChild() 如果传进去`appendChild`的节点已经是文档的一部分，则将该节点从原来的位置转移到新位置
- insertBefore(newNode, node) 第二个参数为参照节点 
- replaceChild(newNode, node) 第二个参数为移除的节点
- removeChild(node) 跟上面一样，移除的节点还是归文档所有，只是在文档中已经没有其位置了
- cloneNode(bool) 创建一个副本，bool表示是否深度复制
- normalize() 找到空文本节点删除，找到相邻文本节点合并

### Document类型
`document`为window的一个属性，因此可以当成全局变量访问

- nodeType === 9
- nodeName === '#document'
- ownerDocument === null
- 子节点可能是一个DocumentType、Element、ProcessingInstruction 或者 Comment
- `document.documentElement`为html元素
- `document.body`保存body引用
- `document.head`
- document.doctype
- document.compatMode
  - CSS1Compat
  - BackCompat
- document.title
- document.URL, document.domain, document.referrer 其中document.domain只能设置为URL中包含的域
- document.readyState
  - loading
  - complete
- document.charset & document.defaultCharset

### 查找元素

- getElementById()
- getElementsByTagName() 不区分大小写

- getElementsByName() 元素也支持这个方法，搜索起点为当前元素
- querySelector() & querySelectorAll() 可以再document和element中使用，返回一个NodeList对象，但是底层实现类似于一组元素快照，而不是不断对文档进行搜索的动态查询。
- getElementsByClassName()

- matchesSelector() 返回一个布尔值

获得的对象为`HTMLCollection`
- 方括号访问（数字或者字符串（name））
- namedItem(name)
- item(index)

特殊集合，都为HTMLCollection
- document.anchors 带有name的a元素
- document.forms 文档中所有form元素
- document.images 文档中所有img元素
- document.links 文档中所有带href特性的a元素

### 文档写入
- document.write()
- document.writeIn() '\n'
- document.open()
- document.close()

### Element 类型
- tagName === nodeName 标签名始终以大写表示
- id、title、lang、dir、className
- getAttribute()、setAttribute()、removeAttribute()
- attributes --> nodelist 拥有以下方法，保存着attr类型节点，可以通过`specified`查看是否定义了属性
  - getNamedItem(name)
  - removeNamedItem() 返回删除的attr节点，可以通过返回节点的nodeValue和nodeName来访问
  - setNamedItem()
  - item(pos)
- classlist --> DOMTokenList
  - add()
  - contains()
  - remove()
  - toggle()
- dataset 自定义属性
- innerHTML html以及table等标签不支持innerHTML
- outerHTML
- innerText
- outerText
- insertAdjacentHTML()
  - "beforebegin"
  - "afterbegin"
  - "beforeend"
  - "afterend"
- children
- contains() 某一个节点是不是另一个节点的后代
- document.createElement(name) 创建Element节点
  
### Text 类型

- nodeType === 3
- nodeName === '#text'
- nodeValue 为文本
- 不支持子节点
- data 文本
- textContent
- appendData()
- deleteData(offset, count)
- insertData(offset, count)
- replaceData(offset, count, text)
- splitText(offset) 分成两个文本节点
- substringData(offset, count)
- document.createTextNode()


### DocumentFragment 类型

- document.createDocumentFragment()

### 操作表格

Table：
- caption
- tBodies
- tFoot
- tHead
- rows HTMLCollection
- createTHead
- createTFoot
- createCaption
- deleteTHead
- deleteTFoot
- deleteCaption
- deleteRow(pos)
- insertRow(pos)

TBody：
- rows
- deleteRow(pos)
- insertRow(pos)

Tr
- cells
- deleteCell(pos)
- insertCell(pos)

### NodeList
- NodeList
- NamedNodeMap
- HTMLCollection

### 元素遍历

- childElementCount
- firstElementChild
- lastElementChild
- previousElementSibling
- nextElementSibling

### 焦点管理

- document.activeElement
- document.hasFocus() 返回布尔值

### scrollIntoView

- scrollIntoView(bool) true/default：顶部尽可能平齐， false：底部尽可能平齐